---
# Fedora setup for GitKraken

- name: Check that GitKraken is installed
  stat:
    path: "{{ gitkraken_install_path }}"
  register: gitkraken_dir


- name: Download GitKraken
  get_url: 
    url: "{{ gitkraken_download_url }}"
    dest: "{{ gitkraken_download_path }}"
  when: gitkraken_dir.stat.exists == False

- name: Create GitKraken directories
  file:
    path: "{{ item }}"
    state: directory
    mode: 0755
  with_items:
    - "{{ gitkraken_install_path }}"
    - "{{ gitkraken_config_path }}"
  become: true

- name: Unpack GitKraken
  unarchive:
    src: "{{ gitkraken_download_path }}"
    dest: "{{ gitkraken_install_path }}"
    remote_src: yes
  become: yes
  when: gitkraken_dir.stat.exists == False

- name: Create desktop entry
  template:
    src: gitkraken.desktop
    dest: /usr/share/applications/gitkraken.desktop
  become: true

- name: Install desktop icon
  copy:
    src: gitkraken.png
    dest: /usr/share/icons/hicolor/512x512/apps/gitkraken.png
  become: true
  notify: "refresh GTK icon cache"
